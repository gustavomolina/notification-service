<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h2>Notification Log</h2>
    <button class="btn btn-sm btn-outline-primary" (click)="refreshData()">
      <i class="bi bi-arrow-clockwise"></i> Refresh
    </button>
  </div>
  <div class="card-body">
    <!-- Stats summary -->
    <div class="stats-summary mb-3">
      <div class="row text-center">
        <div class="col-4">
          <div class="stat-item">
            <div class="stat-value">{{ stats.totalNotifications }}</div>
            <div class="stat-label">Total</div>
          </div>
        </div>
        <div class="col-4">
          <div class="stat-item text-success">
            <div class="stat-value">{{ stats.sentNotifications }}</div>
            <div class="stat-label">Sent</div>
          </div>
        </div>
        <div class="col-4">
          <div class="stat-item text-danger">
            <div class="stat-value">{{ stats.failedNotifications }}</div>
            <div class="stat-label">Failed</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading spinner -->
    <div *ngIf="loading" class="text-center my-4">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading notifications...</p>
    </div>

    <!-- Error message -->
    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>

    <!-- No notifications message -->
    <div *ngIf="!loading && !error && notifications.length === 0" class="text-center my-4">
      <p>No notifications found.</p>
    </div>

    <!-- Notifications list -->
    <div *ngIf="!loading && notifications.length > 0" class="notification-list">
      <div *ngFor="let notification of notifications" class="notification-item">
        <div class="notification-header">
          <span class="badge rounded-pill" [ngClass]="getCategoryBadgeClass(notification.messageCategory)">
            {{ notification.messageCategory }}
          </span>
          <span class="badge rounded-pill ms-2" [ngClass]="getChannelBadgeClass(notification.channel)">
            {{ notification.channel }}
          </span>
          <span class="badge rounded-pill ms-2" [ngClass]="notification.sent ? 'bg-success' : 'bg-danger'">
            {{ notification.sent ? 'Sent' : 'Failed' }}
          </span>
        </div>
        
        <div class="notification-content">
          <p class="message-content">{{ notification.messageContent }}</p>
          <p class="recipient-info">
            To: {{ notification.userName }} 
            <span *ngIf="notification.channel === 'EMAIL'">({{ notification.userEmail }})</span>
            <span *ngIf="notification.channel === 'SMS'">({{ notification.userPhoneNumber }})</span>
          </p>
        </div>
        
        <div class="notification-footer">
          <small class="text-muted">
            Created: {{ formatDate(notification.createdAt) }}
            <span *ngIf="notification.sent">
              | Sent: {{ formatDate(notification.sentAt) }}
            </span>
          </small>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!loading && totalPages > 1" class="d-flex justify-content-between align-items-center mt-3">
      <button 
        class="btn btn-sm btn-outline-primary" 
        [disabled]="currentPage === 0"
        (click)="previousPage()">
        Previous
      </button>
      
      <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
      
      <button 
        class="btn btn-sm btn-outline-primary" 
        [disabled]="currentPage === totalPages - 1"
        (click)="nextPage()">
        Next
      </button>
    </div>
  </div>
</div>